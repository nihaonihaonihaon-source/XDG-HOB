local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local CONFIG_FILE = "PlayerTrackerConfig.json"

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "PlayerTracker"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 300, 0, 400)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 8)
UICorner.Parent = MainFrame

local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 30)
TitleBar.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
TitleBar.Parent = MainFrame

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Name = "TitleLabel"
TitleLabel.Size = UDim2.new(0.7, 0, 1, 0)
TitleLabel.Position = UDim2.new(0, 10, 0, 0)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Text = "玩家追踪器"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
TitleLabel.Font = Enum.Font.GothamSemibold
TitleLabel.TextSize = 14
TitleLabel.Parent = TitleBar

local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Size = UDim2.new(0, 20, 0, 20)
MinimizeButton.Position = UDim2.new(1, -50, 0.5, -10)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(60, 60, 75)
MinimizeButton.Text = "_"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.TextSize = 14
MinimizeButton.Parent = TitleBar

local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Size = UDim2.new(0, 20, 0, 20)
CloseButton.Position = UDim2.new(1, -25, 0.5, -10)
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 12
CloseButton.Parent = TitleBar

local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, 0, 1, -30)
ContentFrame.Position = UDim2.new(0, 0, 0, 30)
ContentFrame.BackgroundTransparency = 1
ContentFrame.Parent = MainFrame

local InputScrollingFrame = Instance.new("ScrollingFrame")
InputScrollingFrame.Name = "InputScrollingFrame"
InputScrollingFrame.Size = UDim2.new(1, -20, 0, 200)
InputScrollingFrame.Position = UDim2.new(0, 10, 0, 10)
InputScrollingFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
InputScrollingFrame.BorderSizePixel = 0
InputScrollingFrame.ScrollBarThickness = 4
InputScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
InputScrollingFrame.Parent = ContentFrame

local InputScrollingFrameUICorner = Instance.new("UICorner")
InputScrollingFrameUICorner.CornerRadius = UDim.new(0, 6)
InputScrollingFrameUICorner.Parent = InputScrollingFrame

local AddInputButton = Instance.new("TextButton")
AddInputButton.Name = "AddInputButton"
AddInputButton.Size = UDim2.new(1, -20, 0, 30)
AddInputButton.Position = UDim2.new(0, 10, 0, 220)
AddInputButton.BackgroundColor3 = Color3.fromRGB(60, 140, 200)
AddInputButton.Text = "+ 添加玩家名称"
AddInputButton.TextColor3 = Color3.fromRGB(255, 255, 255)
AddInputButton.Font = Enum.Font.GothamSemibold
AddInputButton.TextSize = 14
AddInputButton.Parent = ContentFrame

local AddInputButtonUICorner = Instance.new("UICorner")
AddInputButtonUICorner.CornerRadius = UDim.new(0, 6)
AddInputButtonUICorner.Parent = AddInputButton

local TrackButton = Instance.new("TextButton")
TrackButton.Name = "TrackButton"
TrackButton.Size = UDim2.new(1, -20, 0, 40)
TrackButton.Position = UDim2.new(0, 10, 1, -60)
TrackButton.BackgroundColor3 = Color3.fromRGB(70, 160, 70)
TrackButton.Text = "开始追踪"
TrackButton.TextColor3 = Color3.fromRGB(255, 255, 255)
TrackButton.Font = Enum.Font.GothamBold
TrackButton.TextSize = 16
TrackButton.Parent = ContentFrame

local TrackButtonUICorner = Instance.new("UICorner")
TrackButtonUICorner.CornerRadius = UDim.new(0, 8)
TrackButtonUICorner.Parent = TrackButton

local MiniFrame = Instance.new("Frame")
MiniFrame.Name = "MiniFrame"
MiniFrame.Size = UDim2.new(0, 80, 0, 30)
MiniFrame.Position = UDim2.new(1, -90, 0.5, -15)
MiniFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
MiniFrame.Visible = false
MiniFrame.Parent = ScreenGui

local MiniFrameUICorner = Instance.new("UICorner")
MiniFrameUICorner.CornerRadius = UDim.new(0, 6)
MiniFrameUICorner.Parent = MiniFrame

local MiniLabel = Instance.new("TextLabel")
MiniLabel.Name = "MiniLabel"
MiniLabel.Size = UDim2.new(0, 50, 1, 0)
MiniLabel.Position = UDim2.new(0, 5, 0, 0)
MiniLabel.BackgroundTransparency = 1
MiniLabel.Text = "追踪中"
MiniLabel.TextColor3 = Color3.fromRGB(100, 200, 100)
MiniLabel.TextXAlignment = Enum.TextXAlignment.Left
MiniLabel.Font = Enum.Font.GothamSemibold
MiniLabel.TextSize = 12
MiniLabel.Parent = MiniFrame

local ExpandButton = Instance.new("TextButton")
ExpandButton.Name = "ExpandButton"
ExpandButton.Size = UDim2.new(0, 20, 0, 20)
ExpandButton.Position = UDim2.new(1, -25, 0.5, -10)
ExpandButton.BackgroundColor3 = Color3.fromRGB(60, 60, 75)
ExpandButton.Text = "+"
ExpandButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ExpandButton.Font = Enum.Font.GothamBold
ExpandButton.TextSize = 14
ExpandButton.Parent = MiniFrame

local NotificationGui = Instance.new("ScreenGui")
NotificationGui.Name = "TrackerNotifications"
NotificationGui.ResetOnSpawn = false
NotificationGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")

local LoadingFrame = Instance.new("Frame")
LoadingFrame.Name = "LoadingFrame"
LoadingFrame.Size = UDim2.new(1, 0, 1, 0)
LoadingFrame.Position = UDim2.new(0, 0, 0, 0)
LoadingFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
LoadingFrame.BackgroundTransparency = 0.5
LoadingFrame.Visible = false
LoadingFrame.ZIndex = 100
LoadingFrame.Parent = ScreenGui

local LoadingLabel = Instance.new("TextLabel")
LoadingLabel.Name = "LoadingLabel"
LoadingLabel.Size = UDim2.new(0, 300, 0, 50)
LoadingLabel.Position = UDim2.new(0.5, -150, 0.5, -25)
LoadingLabel.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
LoadingLabel.Text = "正在跳转到玩家服务器..."
LoadingLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
LoadingLabel.Font = Enum.Font.GothamBold
LoadingLabel.TextSize = 16
LoadingLabel.Visible = false
LoadingLabel.ZIndex = 101
LoadingLabel.Parent = ScreenGui

local LoadingLabelUICorner = Instance.new("UICorner")
LoadingLabelUICorner.CornerRadius = UDim.new(0, 8)
LoadingLabelUICorner.Parent = LoadingLabel

local localPlayer = Players.LocalPlayer
local trackingData = {}
local isTracking = false
local isMinimized = false
local trackedPlayers = {}
local inputBoxes = {}

local function saveConfig()
local dataToSave = {
trackedPlayers = trackedPlayers,
windowPosition = {
x = MainFrame.Position.X.Scale,
y = MainFrame.Position.Y.Scale,
offsetX = MainFrame.Position.X.Offset,
offsetY = MainFrame.Position.Y.Offset
},
isMinimized = isMinimized
}

end

local function loadConfig()
local success, data = pcall(function()
if readfile and isfile and isfile(CONFIG_FILE) then
return HttpService:JSONDecode(readfile(CONFIG_FILE))
end
end)

end

local function createInputBox(playerName)
local inputBoxFrame = Instance.new("Frame")
inputBoxFrame.Name = "InputBoxFrame"
inputBoxFrame.Size = UDim2.new(1, -10, 0, 35)
inputBoxFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
inputBoxFrame.Parent = InputScrollingFrame

end

local function updateScrollingFrame()
local totalHeight = 0
for _, inputBox in ipairs(inputBoxes) do
totalHeight = totalHeight + inputBox.Size.Y.Offset + 5
end
InputScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, totalHeight)

end

local function teleportToPlayer(playerName)
LoadingFrame.Visible = true
LoadingLabel.Visible = true

end

local function showNotification(title, message, playerName)
local notificationFrame = Instance.new("Frame")
notificationFrame.Name = "Notification"
notificationFrame.Size = UDim2.new(0, 300, 0, 120)
notificationFrame.Position = UDim2.new(1, 10, 0, 10)
notificationFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
notificationFrame.Parent = NotificationGui

end

local function checkPlayerOnline(playerName)
local success, userId = pcall(function()
return Players:GetUserIdFromNameAsync(playerName)
end)

end

local function startTracking()
if isTracking then return end

end

local function stopTracking()
isTracking = false
TrackButton.Text = "开始追踪"
TrackButton.BackgroundColor3 = Color3.fromRGB(70, 160, 70)
MiniLabel.Text = "已暂停"
MiniLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
end

AddInputButton.MouseButton1Click:Connect(function()
local textBox = createInputBox("")
updateScrollingFrame()
textBox:CaptureFocus()
saveConfig()
end)

TrackButton.MouseButton1Click:Connect(function()
if isTracking then
stopTracking()
else
startTracking()
if isMinimized then
MiniLabel.Text = "追踪中"
MiniLabel.TextColor3 = Color3.fromRGB(100, 200, 100)
end
end
end)

MinimizeButton.MouseButton1Click:Connect(function()
isMinimized = true
MainFrame.Visible = false
MiniFrame.Visible = true
saveConfig()
end)

CloseButton.MouseButton1Click:Connect(function()
if isTracking then
isMinimized = true
MainFrame.Visible = false
MiniFrame.Visible = true
saveConfig()
else
ScreenGui:Destroy()
end
end)

ExpandButton.MouseButton1Click:Connect(function()
isMinimized = false
MainFrame.Visible = true
MiniFrame.Visible = false
saveConfig()
end)

local dragging
local dragInput
local dragStart
local startPos

local function update(input)
local delta = input.Position - dragStart
MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

TitleBar.InputBegan:Connect(function(input)
if input.UserInputType == Enum.UserInputType.MouseButton1 then
dragging = true
dragStart = input.Position
startPos = MainFrame.Position

end)

TitleBar.InputChanged:Connect(function(input)
if input.UserInputType == Enum.UserInputType.MouseMovement then
dragInput = input
end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
if input == dragInput and dragging then
update(input)
end
end)

loadConfig()

for _, playerName in ipairs(trackedPlayers) do
createInputBox(playerName)
end

updateScrollingFrame()

if isMinimized then
MainFrame.Visible = false
MiniFrame.Visible = true
else
MainFrame.Visible = true
MiniFrame.Visible = false
end